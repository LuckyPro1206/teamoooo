<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Exportar imagen a RGB</title>
</head>
<body>
    <h2>Convertir imagen a datos RGB</h2>
    <input type="file" id="upload" accept="image/*">
    <button id="exportBtn" disabled>Exportar a RGB</button>
    <br><br>
    <canvas id="canvas" style="display:none;"></canvas>

    <script>
        const upload = document.getElementById("upload");
        const canvas = document.getElementById("canvas");
        const ctx = canvas.getContext("2d");
        const exportBtn = document.getElementById("exportBtn");
        let imgDataArray = [];

        upload.addEventListener("change", function() {
            const file = upload.files[0];
            if (!file) return;
            const img = new Image();
            img.onload = function() {
                canvas.width = img.width;
                canvas.height = img.height;
                ctx.drawImage(img, 0, 0);
                exportBtn.disabled = false;
            };
            img.src = URL.createObjectURL(file);
        });

        exportBtn.addEventListener("click", function() {
            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            const pixels = imageData.data; // RGBA por p√≠xel
            imgDataArray = [];

            for (let i = 0; i < pixels.length; i += 4) {
                imgDataArray.push(pixels[i], pixels[i + 1], pixels[i + 2]); // Solo R, G, B
            }

            const rgbString = imgDataArray.join(",");
            downloadFile(rgbString, "imagen_rgb.txt");
        });

        function downloadFile(content, filename) {
            const blob = new Blob([content], { type: "text/plain" });
            const link = document.createElement("a");
            link.href = URL.createObjectURL(blob);
            link.download = filename;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
    </script>
</body>
</html>